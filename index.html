<!DOCTYPE html>
<html>
<head>
  <title>Voting Page</title>
  <style>
    .error {
      color: red;
      font-weight: bold;
    }
  </style>
  <script>
    function validateForm() {
      var scSelected = false;
      var pcSelected = 0;
      var scCandidate = '';
      var pcCandidates = [];

      var scCandidates = document.getElementsByName('scCandidate');
      for (var i = 0; i < scCandidates.length; i++) {
        if (scCandidates[i].checked) {
          scSelected = true;
          scCandidate = scCandidates[i].value;
          break;
        }
      }

      var pcCandidates = document.getElementsByName('pcCandidate');
      for (var i = 0; i < pcCandidates.length; i++) {
        if (pcCandidates[i].checked) {
          pcSelected++;
          pcCandidates.push(pcCandidates[i].value);
        }
      }

      if (!scSelected || pcSelected === 0) {
        document.getElementById('error').innerHTML = 'Please select a candidate in each category.';
        return false;
      }

      if (pcSelected > 2) {
        document.getElementById('error').innerHTML = 'You can vote for at most two candidates in the PC category.';
        return false;
      }

      // Save the voting data to CSV
      var data = 'Category,Selected Candidate\n';
      data += 'SC,' + scCandidate + '\n';
      for (var i = 0; i < pcCandidates.length; i++) {
        data += 'PC,' + pcCandidates[i] + '\n';
      }

      var link = document.createElement('a');
      link.href = 'data:text/csv;charset=utf-8,' + encodeURI(data);
      link.download = 'voting_results.csv';
      link.click();

      return true;
    }
  </script>
</head>
<body>
  <h1>Voting Page</h1>

  <form onsubmit="return validateForm()">
    <h2>Category: Steering Committee</h2>
    <p>Please vote in at most one candidate</p> 
    <input type="radio" name="scCandidate" value="Sandra Alves"> Sandra Alves<br>
    <input type="radio" name="scCandidate" value="Roberto Blanco"> Roberto Blanco<br>
    <input type="radio" name="scCandidate" value="Frédéric Blanqui"> Frédéric Blanqui<br>
    <input type="radio" name="scCandidate" value="Alberto Ciaffaglione"> Alberto Ciaffaglione<br>
    <input type="radio" name="scCandidate" value="Gilles Dowek"> Gilles Dowek<br>
    <input type="radio" name="scCandidate" value="Carlos Olarte"> Carlos Olarte<br>
    <input type="radio" name="scCandidate" value="Enrico Tassi"> Enrico Tassi<br>
    <input type="radio" name="scCandidate" value="Aaron Stump"> Aaron Stump<br>
    <input type="radio" name="scCandidate" value="Nora Szasz"> Nora Szasz<br>
    <input type="radio" name="scCandidate" value="" checked> No Vote<br>

    <h2>Category: PC-chair LFMTP2024</h2>
    <p>Please vote in at most two candidates</p> 
    <input type="checkbox" name="pcCandidate" value="Andreas Abe"> Andreas Abe<br>
    <input type="checkbox" name="pcCandidate" value="Claudio Sacerdoti Coen"> Claudio Sacerdoti Coen<br>
    <input type="checkbox" name="pcCandidate" value="Florian Rabe"> Florian Rabe<br>
    <input type="checkbox" name="pcCandidate" value="Aaron Stump"> Aaron Stump<br>
    <input type="checkbox" name="pcCandidate" value="Nora Szasz"> Nora Szasz<br>
    <input type="checkbox" name="pcCandidate" value="" checked> No Vote<br>

    <br>
    <input type="submit" value="Submit Vote">
  </form>

  <p id="error" class="error"></p>
</body>
</html>
